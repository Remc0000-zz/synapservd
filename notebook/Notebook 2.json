{
	"name": "Notebook 2",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "sparkpool",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"87c97560-445b-4796-b5f9-af5e6c03a5d5": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"_c29": "user_defined_information",
										"_c11": "object_id",
										"_c18": "target_server_principal_sid",
										"_c21": "database_name",
										"_c13": "session_server_principal_name",
										"_c32": "transaction_id",
										"_c3": "succeeded",
										"_c24": "statement",
										"_c5": "is_column_permission",
										"_c10": "target_database_principal_id",
										"_c35": "duration_milliseconds",
										"_c0": "event_time",
										"_c4": "permission_bitmask",
										"_c33": "client_ip",
										"_c9": "target_server_principal_id",
										"_c28": "user_defined_event_id",
										"_c39": "data_sensitivity_information",
										"_c22": "schema_name",
										"_c14": "server_principal_name",
										"_c8": "database_principal_id",
										"_c25": "additional_information",
										"_c17": "target_server_principal_name",
										"_c36": "response_rows",
										"_c20": "server_instance_name",
										"_c1": "sequence_number",
										"_c31": "sequence_group_id",
										"_c38": "connection_id",
										"_c27": "audit_file_offset",
										"_c16": "database_principal_name",
										"_c37": "affected_rows",
										"_c7": "server_principal_id",
										"_c26": "file_name",
										"_c15": "server_principal_sid",
										"_c30": "audit_schema_version",
										"_c2": "action_id",
										"_c12": "class_type",
										"_c40": "host_name;;;",
										"_c19": "target_database_principal_name",
										"_c34": "application_name",
										"_c6": "session_id",
										"_c23": "object_name"
									},
									{
										"_c11": "-1008137134",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "107540",
										"_c3": "1",
										"_c24": "EXEC xp_cmdshell 'DIR E:\\SQL2017\\SQL_Tempdb*.* /b'",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "53:23.7",
										"_c4": "0x00000000000000000000000000000020",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c22": "sys",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0xC4483CAB2D556B4CB9F3FEB36B736406",
										"_c38": "C78F62BE-A1B4-447F-8648-7C74CD53CFD0",
										"_c27": "6144",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit_xp_cmdshell_9208E581-5808-4444-ACA2-5E7D549F0397_0_132428155713860000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "EX  ",
										"_c12": "X ",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "53",
										"_c23": "xp_cmdshell"
									},
									{
										"_c11": "-1008137134",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "0",
										"_c3": "1",
										"_c24": "EXEC xp_cmdshell 'DIR D:\\SQL2019\\*.* /b'",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "53:44.3",
										"_c4": "0x00000000000000000000000000000020",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c22": "sys",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0x005B86BD65611F42A6E60BCE4712533A",
										"_c38": "C78F62BE-A1B4-447F-8648-7C74CD53CFD0",
										"_c27": "7168",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit_xp_cmdshell_9208E581-5808-4444-ACA2-5E7D549F0397_0_132428155713860000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "EX  ",
										"_c12": "X ",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "53",
										"_c23": "xp_cmdshell"
									},
									{
										"_c11": "-1008137134",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "561920",
										"_c3": "1",
										"_c24": "EXEC xp_cmdshell 'DIR D:\\SQL2019\\*.* /b'",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "10:54.2",
										"_c4": "0x00000000000000000000000000000020",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c22": "sys",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0x71906DAE332B494A8FF9802BD285B6EE",
										"_c38": "4E928DDE-FD19-4827-A0E6-41ADF47CDBA2",
										"_c27": "5632",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit_xp_cmdshell_9208E581-5808-4444-ACA2-5E7D549F0397_0_132481734546910000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "EX  ",
										"_c12": "X ",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "test1",
										"_c6": "69",
										"_c23": "xp_cmdshell"
									},
									{
										"_c11": "0",
										"_c13": "10F9E2C7-818B-4E54-AFFE-E338A2CB66BE",
										"_c3": "0",
										"_c5": "1",
										"_c10": "0",
										"_c0": "\"57:42.3,1,AUSC,1,0x00000000000000000000000000000000,0,175,259,0,0,0,0,A ,EUROPE\\jackyho,EUROPE\\jackyho,0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE,,,NULL,,JACKYHOWIN123A\\SQL2019,,,,,\"\"<action_info xmlns=\"\"\"\"http://schemas.microsoft.com/sqlserver/2008/sqlaudit_data\"\"\"\"><session><![CDATA[Audit-20210129-093754$A]]></session><action>event enabled</action><startup_type>manual</startup_type><object><![CDATA[audit_event]]></object></action_info>\"\"",
										"_c9": "Microsoft SQL Server Management Studio",
										"_c8": "local machine",
										"_c1": "D:\\SQL2019\\SQL_Audit\\Audit-20210129-093754_EBA1B29C-004C-4273-BB13-B758E531E0B5_0_132563842622890000.sqlaudit",
										"_c7": "0",
										"_c15": "JACKYHOWIN123A\";;;",
										"_c2": "6144",
										"_c12": "0",
										"_c6": "0x00000000000000000000000000000000"
									},
									{
										"_c11": "0",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "0",
										"_c3": "1",
										"_c24": "dbcc loginfo()",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "57:50.6",
										"_c4": "0x00000000000000000000000000000000",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0xBF837DB6DCBB1644984FF4856C7D9D69",
										"_c38": "1A6C72C1-5E89-42E8-997B-C6F5F1A53A32",
										"_c27": "7680",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit-20210129-093754_EBA1B29C-004C-4273-BB13-B758E531E0B5_0_132563842622890000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "DBCC",
										"_c12": "DB",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "59"
									},
									{
										"_c11": "0",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "0",
										"_c3": "1",
										"_c24": "dbcc loginfo()",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "57:50.7",
										"_c4": "0x00000000000000000000000000000000",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0x65BF84F644A510499B9CDBBF211E6338",
										"_c38": "1A6C72C1-5E89-42E8-997B-C6F5F1A53A32",
										"_c27": "7680",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit-20210129-093754_EBA1B29C-004C-4273-BB13-B758E531E0B5_0_132563842622890000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "DBCC",
										"_c12": "DB",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "59"
									},
									{
										"_c11": "0",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "0",
										"_c3": "1",
										"_c24": "dbcc loginfo()",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "57:50.8",
										"_c4": "0x00000000000000000000000000000000",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0x3547B1AD5AF9BF4FB99CB8A17D9C7540",
										"_c38": "1A6C72C1-5E89-42E8-997B-C6F5F1A53A32",
										"_c27": "7680",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit-20210129-093754_EBA1B29C-004C-4273-BB13-B758E531E0B5_0_132563842622890000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "DBCC",
										"_c12": "DB",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "59"
									},
									{
										"_c11": "0",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "0",
										"_c3": "1",
										"_c24": "dbcc loginfo()",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "57:50.8",
										"_c4": "0x00000000000000000000000000000000",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0x3A27721326AA01438DD449540F6EA9DD",
										"_c38": "1A6C72C1-5E89-42E8-997B-C6F5F1A53A32",
										"_c27": "7680",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit-20210129-093754_EBA1B29C-004C-4273-BB13-B758E531E0B5_0_132563842622890000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "DBCC",
										"_c12": "DB",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "59"
									},
									{
										"_c11": "0",
										"_c18": "NULL",
										"_c21": "master",
										"_c13": "EUROPE\\jackyho",
										"_c32": "0",
										"_c3": "1",
										"_c24": "dbcc loginfo()",
										"_c5": "0",
										"_c10": "0",
										"_c35": "0",
										"_c0": "57:50.9",
										"_c4": "0x00000000000000000000000000000000",
										"_c33": "local machine",
										"_c9": "0",
										"_c28": "0",
										"_c14": "EUROPE\\jackyho",
										"_c8": "1",
										"_c36": "0",
										"_c20": "JACKYHOWIN123A\\SQL2019",
										"_c1": "1",
										"_c31": "0xEC70FCD0124E9E439FF9C4578F1A66C7",
										"_c38": "1A6C72C1-5E89-42E8-997B-C6F5F1A53A32",
										"_c27": "7680",
										"_c16": "dbo",
										"_c37": "0",
										"_c7": "259",
										"_c26": "D:\\SQL2019\\SQL_Audit\\Audit-20210129-093754_EBA1B29C-004C-4273-BB13-B758E531E0B5_0_132563842622890000.sqlaudit",
										"_c15": "0x010500000000000C0100000015519B7F89D3B54EBD2C9633E723AEDE",
										"_c30": "1",
										"_c2": "DBCC",
										"_c12": "DB",
										"_c40": "JACKYHOWIN123A;;;",
										"_c34": "Microsoft SQL Server Management Studio - Query",
										"_c6": "59"
									}
								],
								"schema": {
									"_c0": "string",
									"_c1": "string",
									"_c2": "string",
									"_c3": "string",
									"_c4": "string",
									"_c5": "string",
									"_c6": "string",
									"_c7": "string",
									"_c8": "string",
									"_c9": "string",
									"_c10": "string",
									"_c11": "string",
									"_c12": "string",
									"_c13": "string",
									"_c14": "string",
									"_c15": "string",
									"_c16": "string",
									"_c17": "string",
									"_c18": "string",
									"_c19": "string",
									"_c20": "string",
									"_c21": "string",
									"_c22": "string",
									"_c23": "string",
									"_c24": "string",
									"_c25": "string",
									"_c26": "string",
									"_c27": "string",
									"_c28": "string",
									"_c29": "string",
									"_c30": "string",
									"_c31": "string",
									"_c32": "string",
									"_c33": "string",
									"_c34": "string",
									"_c35": "string",
									"_c36": "string",
									"_c37": "string",
									"_c38": "string",
									"_c39": "string",
									"_c40": "string"
								}
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "count",
									"categoryFieldKeys": [
										"_c0"
									],
									"seriesFieldKeys": [
										"_c0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/2de5e948-c957-42f1-9c13-477b2e5fc44a/resourceGroups/synapseNEW/providers/Microsoft.Synapse/workspaces/rvdworkspace/bigDataPools/sparkpool",
				"name": "sparkpool",
				"type": "Spark",
				"endpoint": "https://rvdworkspace.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/sparkpool",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net"
				},
				"sparkVersion": "2.4",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"automaticScaleJobs": false
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "code",
				"metadata": {
					"microsoft": {
						"language": "python"
					},
					"collapsed": false
				},
				"source": [
					"%%pyspark\n",
					"blob_account_name = \"blobremco\"\n",
					"blob_container_name = \"adfdemo\"\n",
					"from pyspark.sql import SparkSession\n",
					"\n",
					"sc = SparkSession.builder.getOrCreate()\n",
					"token_library = sc._jvm.com.microsoft.azure.synapse.tokenlibrary.TokenLibrary\n",
					"blob_sas_token = token_library.getConnectionString(\"BlobRemco\")\n",
					"\n",
					"spark.conf.set(\n",
					"    'fs.azure.sas.%s.%s.blob.core.windows.net' % (blob_container_name, blob_account_name),\n",
					"    blob_sas_token)\n",
					"df = spark.read.load('wasbs://adfdemo@blobremco.blob.core.windows.net/SQLLogs/demoauditfile.csv', format='csv'\n",
					"## If header exists uncomment line below\n",
					"##, header=True\n",
					")\n",
					"display(df.limit(10))"
				],
				"execution_count": 1
			}
		]
	}
}